var sDeviceID="",sDevicePlatform="windows",sDevicePlatformVersion="7",sBufferXMLData="",sLayoutID="-1",sLayoutName="",sCompanyID="-1",sLocation="Indonesia",sUserID="-1",sXMLUrl="",iXMLVersionNumber=0,sPreloadImages="",bFirstLoad=!0,iShowDebugLog=-1,iMixedContentTimerID=-1,iVersionCheckTimer=-1,iVideoCount=0,arUpdatableFileList=[],arUpdatableFileFlag=[],arUpdatableFileMD5=[],arUpdatableFileMD5Result=[],iUpdatableDownloadCounter=0,bDownloadFailed=!1,bDownloading=!1,sOnlineMode="Unknown",sVLCOnly="0",iShowLiveStream=-1,bShowingMenu=!0,bCheckingVersion=!1,iCheckLiveStreamTimer=-1,arFirstSlideLoop=[],sInitScreen1=$("#dvInitScreen1").html(),sInitScreen2=$("#dvInitScreen2").html(),sInitScreen2b=$("#dvInitScreen2b").html();function onDeviceReady(){initContent()}function initContent(){if(bShowingMenu=!0,$(".dvReset").css("visibility","hidden"),$(".dvReset").css("display","none"),$("#dvLiveStreamVLC").css("visibility","hidden"),$("#dvLiveStreamVLC").css("display","none"),$("#dvLiveStreamAndroid").css("visibility","hidden"),$("#dvLiveStreamAndroid").css("display","none"),MovingTextEnd(),ClearAllTimeouts(),iCheckLiveStreamTimer>-1&&clearInterval(iCheckLiveStreamTimer),iMixedContentTimerID>-1&&clearInterval(iMixedContentTimerID),-1!=iVersionCheckTimer&&clearInterval(iVersionCheckTimer),isVideoPlaying1=!1,isVideoEnded1=!1,isVideoPlaying2=!1,isVideoEnded2=!1,"windows"==sDevicePlatform)try{window.external.VLCPlayerStop()}catch(e){}if(initDevice(),isXMLDataExist()){var e=getXMLDataStringFromStorage();if(bFirstLoad)bFirstLoad=!1,deleteCache(),loadLayoutFromStorage(!0),runCheckVersionTimer();else if(sXMLUrl.indexOf(".xml")>=0){$("#spRegions").html(sInitScreen2b),$("#btnBack").css("visibility","visible"),$("#btnBack").css("display","block");var t=$("layout",e.data);$(t).each(function(){var e=$(this).find("version").text(),t=$(this).find("group").text(),i=($(this).find("subgroup").text(),$(this).find("screen>width").text()),a=$(this).find("screen>height").text();$("#spSTBCompanyB").html(t),$("#spSTBResolution").html(i+" x "+a),$("#spSTBVersion").html(e),""==sDeviceID&&(sDeviceID="proto12345"),$("#spSTBID").html(GetDeviceID()),$("#spSTBIDb").html(GetDeviceID()),$("#spSTBOS").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBOSb").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBLayout").html(sLayoutName),$("#spSTBLocation").html(sLocation),$("#spSTBConnection").html(sOnlineMode),$("#spSTBConnectionb").html(sOnlineMode)})}else{$("#spRegions").html(sInitScreen2),$("#btnBack").css("visibility","visible"),$("#btnBack").css("display","block");t=$("layout",e.data);$(t).each(function(){$(this).find("version").text();var e=$(this).find("group").text();$(this).find("subgroup").text(),$(this).find("screen>width").text(),$(this).find("screen>height").text();$("#spSTBCompany").html(e),""==sDeviceID&&(sDeviceID="proto12345"),$("#spSTBID").html(GetDeviceID()),$("#spSTBIDb").html(GetDeviceID()),$("#spSTBOS").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBOSb").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBLayout").html(sLayoutName),$("#spSTBLocation").html(sLocation),$("#spSTBConnection").html(sOnlineMode),$("#spSTBConnectionb").html(sOnlineMode)})}}else $("#spMovingText").html(""),$("#spRegions").html(sInitScreen1),$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID)}function initDevice(){try{var e=""+device.uuid,t=""+device.platform,i=""+device.version;SetDeviceID(e.toLowerCase()),SetDevicePlatform(t.toLocaleLowerCase(),i.toLocaleLowerCase())}catch(e){}try{writeToFile("notfound.txt","404")}catch(e){}}function getJSONDataStringFromURLAsync(e,t,i){try{$.ajax({type:"POST",method:"POST",cache:!1,url:e,dataType:"json",contentType:"application/x-www-form-urlencoded",data:t+"&r="+getRandomID(10),processData:!1,crossDomain:!0,async:!0,success:function(e){var t={success:!0,data:e};if(1==i)try{if(t.success){var a=t.data.verno,o=t.data.reqcode,r=t.data.reqtag,n=t.data.reqpar,s=0;try{s=parseInt(t.data.success)}catch(e){s=0}if(isNaN(s)&&(s=0),-1==s){if($(".dvReset").css("visibility","hidden"),$(".dvReset").css("display","none"),ClearAllTimeouts(),iMixedContentTimerID>-1&&clearInterval(iMixedContentTimerID),-1!=iVersionCheckTimer&&clearInterval(iVersionCheckTimer),isVideoPlaying1=!1,isVideoEnded1=!1,isVideoPlaying2=!1,isVideoEnded2=!1,"windows"==sDevicePlatform)try{window.external.VLCPlayerStop()}catch(e){}bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),$("#spRegions").html(sInitScreen1);try{$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID)}catch(e){}return void MAlert("This device has been reset from CMS.")}a<=iXMLVersionNumber?(bCheckingVersion=!1,10!=iShowDebugLog&&(1==o?getTextLog(r,n):2==o&&getScreenShot(r))):getJSONDataStringFromURLAsync(sXMLUrl,"act=getlayoutdata&deviceid="+GetDeviceID()+"&layoutid="+sLayoutID+"&r="+getRandomID(10),2)}}catch(e){}else if(2==i){try{if(t.success){var l=decodeURIComponent((t.data.xmldata+"").replace(/\+/g,"%20")),d=$("layout",l);$(d).each(function(){var e=$(this).find("version").text(),t=parseInt(e);if(isNaN(t)&&(t=0),t>iXMLVersionNumber)try{sBufferXMLData=l,setXMLDataStringToStorage(l),deleteCache(),-1!=iVersionCheckTimer&&clearInterval(iVersionCheckTimer),iLoadImageTimer=0,bFirstLoad=!1,isVideoPlaying1=!1,isVideoEnded1=!1,isVideoPlaying2=!1,isVideoEnded2=!1,MovingTextEnd(),ClearAllTimeouts(),loadLayoutFromStorage(!0)}catch(e){}})}}catch(e){}bCheckingVersion=!1}else bCheckingVersion=!1},error:function(e){!1,bCheckingVersion=!1;try{void 0===e.responseJSON.errmsg&&e.status+" "+e.statusText}catch(t){e.status+" "+e.statusText}},timeout:1e4})}catch(e){bCheckingVersion=!1}}function getJSONDataStringFromURL(e,t){var i,a=!1;try{$.ajax({type:"POST",method:"POST",cache:!1,url:e,dataType:"json",contentType:"application/x-www-form-urlencoded",data:t+"&r="+getRandomID(10),processData:!1,crossDomain:!0,async:!1,success:function(e){i=e,a=!0},error:function(e){a=!1;try{void 0===(i=e.responseJSON.errmsg)&&(i=e.status+" "+e.statusText)}catch(t){i=e.status+" "+e.statusText}},timeout:3e3})}catch(e){a=!1,i=""}return{success:a,data:i}}function getXMLDataStringFromURL(e){var t=!1,i="";try{$.ajax({type:"GET",cache:!1,url:e,dataType:"xml",crossDomain:!0,async:!1,success:function(e){(new XMLSerializer).serializeToString(e);i=(new XMLSerializer).serializeToString(e),t=!0},error:function(e,a,o){t=!1,i=""},timeout:5e3})}catch(e){t=!1,i=""}return{success:t,data:i}}function setDownloadingStatus(){try{var e=0;1==bDownloading&&(e=1);try{window.localStorage.setItem("filedownloading",e)}catch(e){}if("windows"==sDevicePlatform)try{window.external.SetLocalStorage("filedownloading",e)}catch(e){}}catch(e){}}function getDownloadingStatus(){var e=!1;try{var t=0;try{t=window.localStorage.getItem("filedownloading")}catch(e){}if("windows"==sDevicePlatform)try{t=window.external.GetLocalStorage("filedownloading")}catch(e){}1==t&&(e=!0)}catch(e){}return e}function setXMLDataStringToStorage(e){var t=!1;try{"0"!=sVLCOnly&&"1"!=sVLCOnly&&(sVLCOnly="0");try{window.localStorage.setItem("xmldata",e),window.localStorage.setItem("xmlurl",sXMLUrl),window.localStorage.setItem("layoutid",sLayoutID),window.localStorage.setItem("layoutname",sLayoutName),window.localStorage.setItem("location",sLocation),window.localStorage.setItem("companyid",sCompanyID),window.localStorage.setItem("deviceid",sDeviceID),window.localStorage.setItem("network",sOnlineMode),window.localStorage.setItem("vlc",sVLCOnly),t=!0}catch(e){}if("windows"==sDevicePlatform)try{window.external.SetLocalStorage("xmldata",e),window.external.SetLocalStorage("xmlurl",sXMLUrl),window.external.SetLocalStorage("layoutid",sLayoutID),window.external.SetLocalStorage("layoutname",sLayoutName),window.external.SetLocalStorage("location",sLocation),window.external.SetLocalStorage("companyid",sCompanyID),window.external.SetLocalStorage("deviceid",sDeviceID),window.external.SetLocalStorage("network",sOnlineMode),window.external.SetLocalStorage("vlc",sVLCOnly),t=!0}catch(e){}}catch(e){t=!1}return t}function getXMLDataStringFromStorage(){var e=!1,t="";try{try{t=window.localStorage.getItem("xmldata"),sXMLUrl=window.localStorage.getItem("xmlurl"),sLayoutID=window.localStorage.getItem("layoutid"),sLayoutName=window.localStorage.getItem("layoutname"),sLocation=window.localStorage.getItem("location"),sCompanyID=window.localStorage.getItem("companyid"),sDeviceID=window.localStorage.getItem("deviceid"),sOnlineMode=window.localStorage.getItem("network"),sVLCOnly=window.localStorage.getItem("vlc")}catch(e){}if("windows"==sDevicePlatform)try{t=window.external.GetLocalStorage("xmldata"),sXMLUrl=window.external.GetLocalStorage("xmlurl"),sLayoutID=window.external.GetLocalStorage("layoutid"),sLayoutName=window.external.GetLocalStorage("layoutname"),sLocation=window.external.GetLocalStorage("location"),sCompanyID=window.external.GetLocalStorage("companyid"),sDeviceID=window.external.GetLocalStorage("deviceid"),sOnlineMode=window.external.GetLocalStorage("network"),sVLCOnly=window.external.GetLocalStorage("vlc")}catch(e){}null==t||""==t?(e=!1,t=""):e=!0}catch(i){e=!1,t=""}return"0"!=sVLCOnly&&"1"!=sVLCOnly&&(sVLCOnly="0"),{success:e,data:t}}function isXMLDataExist(){var e="";try{e=window.localStorage.getItem("xmldata")}catch(e){}if("windows"==sDevicePlatform)try{e=window.external.GetLocalStorage("xmldata")}catch(e){}return null!=e&&""!=e}function deleteXMLDataStringFromStorage(){try{window.localStorage.removeItem("xmldata")}catch(e){}try{"windows"==sDevicePlatform&&window.external.DeleteLocalStorage("xmldata")}catch(e){}}function stbRetrieve(){var e="",t="",i="",a="",o="";try{if(e=document.getElementById("txServerIP").value,t=document.getElementById("txServerPort").value,i=document.getElementById("txUserName").value,a=document.getElementById("txUserPass").value,"core"==e||"0"==e){if(sXMLUrl=o="data.xml",(n=getXMLDataStringFromURL(o)).success){sBufferXMLData=n.data,$("#spRegions").html(sInitScreen2b),bFirstLoad?($("#btnBack").css("visibility","hidden"),$("#btnBack").css("display","none")):($("#btnBack").css("visibility","visible"),$("#btnBack").css("display","block"));var r=$("layout",n.data);$(r).each(function(){var e=$(this).find("version").text(),t=$(this).find("group").text(),i=$(this).find("subgroup").text(),a=$(this).find("screen>width").text(),o=$(this).find("screen>height").text();$("#spSTBCompanyB").html(t+"</br>"+i),$("#spSTBResolution").html(a+" x "+o),$("#spSTBVersion").html(e),""==sDeviceID&&(sDeviceID="proto12345"),$("#spSTBID").html(GetDeviceID()),$("#spSTBIDb").html(GetDeviceID()),$("#spSTBOS").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBOSb").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBLocation").html(sLocation),$("#spSTBConnection").html(sOnlineMode),$("#spSTBConnectionb").html(sOnlineMode)})}else MAlert("Failed to load layout data from "+o+".");return}var n;if(""==t&&(t="80"),"1"==e&&(e="192.168.0.236",t="80",i="nspushmail@gmail.com",a="st3ph3n"),sXMLUrl=o="http://"+e+":"+t+"/stbapi.php",(n=getJSONDataStringFromURL(o,"act=login&uname="+i+"&passwd="+a+"&r="+getRandomID(10))).success)try{if(1==n.data.success){$("#spRegions").html(sInitScreen2),bFirstLoad?($("#btnBack").css("visibility","hidden"),$("#btnBack").css("display","none"),$("#btnReset").val("CANCEL"),$("#spSTBLocation").html("<input id='txLocation' type='text' inputmode='text' style='width:55%;' maxlength='249' />")):($("#btnBack").css("visibility","visible"),$("#btnBack").css("display","block"),$("#spSTBLocation").html(sLocation),$("#spSTBConnection").html(sOnlineMode),$("#spSTBConnectionb").html(sOnlineMode)),$("#spSTBCompany").html(n.data.companyname),""==sDeviceID&&(sDeviceID="proto12345"),$("#spSTBID").html(GetDeviceID()),$("#spSTBIDb").html(GetDeviceID()),$("#spSTBOS").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBOSb").html(GetDevicePlatformName()+" "+GetDevicePlatformVersion()),$("#spSTBConnection").html(sOnlineMode),$("#spSTBConnectionb").html(sOnlineMode),sUserID=""+n.data.userid,sCompanyID=""+n.data.companyid;for(var s="",l=0;l<n.data.layout.length;l++)s+="<option value='"+n.data.layout[l].id+"'>"+n.data.layout[l].name+"</option>";n.data.layout.length>0&&(s="<select id='ddSTBLayout' style='position:absolute;min-width: 30%;max-width: 99%'>"+s+"</select>",$("#spSTBLayout").html(s)),$("#spSTBConnection").html(sOnlineMode)}else MAlert(n.data.errmsg)}catch(e){MAlert("JSON data received but invalid.")}else{var d="";try{d=n.data}catch(e){}MAlert("Failed to load JSON data from "+o+". "+d)}}catch(e){MAlert(e.message)}}function stbBack(){for(var e=0,t=0;t<arUpdatableFileMD5Result.length;t++)"0"==arUpdatableFileMD5Result[t]&&e++;if(e>0)return $("#spRegions").html("<div style='width:100%;height:100%;background-color:black;'><center><h1 style='color:white;'><br/><br/><br/><br/><br/>Invalid content detected, please reset device!</h1></center></div>"),$(".dvReset").css("visibility","visible"),void $(".dvReset").css("display","block");loadLayoutFromStorage(!1),runCheckVersionTimer()}function stbReset(){if(bFirstLoad)return bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),void $("#spRegions").html(sInitScreen1);if(MConfirm("Are you sure? This will delete the current saved layout permanently."))try{if("Offline"==sOnlineMode){bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),$("#spRegions").html(sInitScreen1);try{$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID)}catch(e){}}else if(oData=getJSONDataStringFromURL(sXMLUrl,"act=unreg&deviceid="+GetDeviceID()+"&companyid="+sCompanyID+"&r="+getRandomID(10)),oData.success){oData.success;bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),$("#spRegions").html(sInitScreen1);try{$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID)}catch(e){}}else MAlert("Unable to request reset, reset cancelled!")}catch(e){MAlert("Unable to request reset, reset cancelled!")}}function stbReset2(){try{if(bDownloading&&ClearAllTimeouts(),oData=getJSONDataStringFromURL(sXMLUrl,"act=unreg&deviceid="+GetDeviceID()+"&r="+getRandomID(10)),oData.success){oData.success;$("#btnReset2").css("visibility","hidden"),$("#spMovingText").html(""),$("#spRegions").html(sInitScreen1);try{$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID)}catch(e){}}else MAlert("Unable to request reset, reset cancelled!"),bDownloading&&($("#spPrepInfo").html(""),loadLayoutFromStorage(!0))}catch(e){MAlert("Unable to request reset, reset cancelled!"),bDownloading&&($("#spPrepInfo").html(""),loadLayoutFromStorage(!0))}}function stbSave(){try{var e;if(bFirstLoad){sLayoutID=$("#ddSTBLayout").val(),sLayoutName=$("#ddSTBLayout :selected").text(),sLocation=$("#txLocation").val(),e=getJSONDataStringFromURL(sXMLUrl,"act=reg&location="+encodeURI(sLocation)+"&companyid="+sCompanyID+"&userid="+sUserID+"&deviceid="+GetDeviceID()+"&osversion="+GetDevicePlatformVersion()+"&deviceos="+GetDevicePlatformName()+"&layoutid="+sLayoutID+"&r="+getRandomID(10));var t="";try{t=e.data}catch(e){t=e.message}if(!e.success)return sXMLUrl.indexOf(".xml")>=0?setXMLDataStringToStorage(sBufferXMLData)?(deleteCache(),void loadLayoutFromStorage(!0)):void 0:(MAlert("Unable to register STB! "+t),bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),void $("#spRegions").html(sInitScreen1));e.success}if(!(e=getJSONDataStringFromURL(sXMLUrl,"act=getlayoutdata&deviceid="+GetDeviceID()+"&layoutid="+sLayoutID+"&r="+getRandomID(10))).success)return MAlert("Unable to get layout! "+e.data),bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),void $("#spRegions").html(sInitScreen1);if(setXMLDataStringToStorage(sBufferXMLData=decodeURIComponent((e.data.xmldata+"").replace(/\+/g,"%20"))))return deleteCache(),void loadLayoutFromStorage(!0)}catch(e){}MAlert("Layout is not saved!"),bFirstLoad=!0,deleteXMLDataStringFromStorage(),sBufferXMLData="",$("#spMovingText").html(""),$("#spRegions").html(sInitScreen1)}function loadLayoutFromStorage(e){var t="";RegionListClear(),initDevice();try{t=window.localStorage.getItem("xmldata")}catch(e){}if("windows"==sDevicePlatform)try{t=window.external.GetLocalStorage("xmldata")}catch(e){}try{var i=$("layout",t);$(i).each(function(){var e=$(this).find("version").text();iXMLVersionNumber=parseInt(e,10),isNaN(iXMLVersionNumber)&&(iXMLVersionNumber=0)})}catch(e){iXMLVersionNumber=0}sBufferXMLData=t;i=$("region",t);var a="",o="",r=0;iVideoCount=0,bFirstLoad=!1,bFirstSlide=!0,arUpdatableFileList=[],arUpdatableFileFlag=[],arUpdatableFileMD5=[],arUpdatableFileMD5Result=[],$("#spPreLoadImages").html(""),sPreloadImages="";var n=0;$(i).each(function(){var e="",t=$(this).find("posx").text(),i=$(this).find("posy").text(),s=$(this).find("posz").text(),l=$(this).find("width").text(),d=$(this).find("height").text(),c=$(this).find("name").text(),m=1;try{m=parseInt(s,10),isNaN(m)&&(m=1),m*=10}catch(e){m=1}a+="<div style='position:absolute; top:"+i+"%; left:"+t+"%; width: "+l+"%; height: "+d+"%; z-index: "+m+"; background-color: transparent;' >";var g=0,p=0,v=0,h=0;glMovingTextPlaylist=[];var y=$(this).find("playlist>material");$(y).each(function(){e=$(this).find("media").text();var a=removeLineBreaks($(this).find("url").text()),m=$(this).find("materialid").text(),y=$(this).find("url").attr("linktype"),u=1;try{u=parseInt($(this).find("new").text())}catch(e){u=1}if(isNaN(u)&&(u=1),"core"==y?a="md/"+a:"live"==y||"updatable"!=y||"image"!=e&&"video"!=e&&"video2"!=e&&"background"!=e||(arUpdatableFileList.push(a),arUpdatableFileFlag.push(u),arUpdatableFileMD5.push(m),arUpdatableFileMD5Result.push("1"),a=0==(a=getUpdatableFolder()+getFilename(a)).indexOf("/")?"file://"+a:"file:///"+a),"1"!=sVLCOnly&&"video2"==e&&(e="video"),"android"==GetDevicePlatformName()&&"video2"==e&&(e="video"),"video2"==e&&"proto12345"==GetDeviceID()&&(e="video"),"background"==e){var f=$(this).find("bgcolor").text();1==++p&&(""!=a?(sPreloadImages+="<img src='"+a+"'>",o+="<img class='nocursor' src='"+a+"?r="+getRandomID(10)+"' srcori='"+a+"' style='position:absolute; width: 100%; height: 100%;' alt='' onerror='this.src=\"md/black1px.png\"'>"):o+="<div class='nocursor' style='width:100%;height:100%;background-color:"+f+";'></div>")}else if("webview"==e){f=$(this).find("bgcolor").text();var S="wv"+getRandomID(10);1==++v&&(o+=""!=a?"<div style='width:100%;height:100%;border:none;'><iframe src='"+a+"' id='"+S+"' name='"+S+"' style='width:100%;height:100%;border:none;background-color:"+f+";' sandbox='allow-forms allow-pointer-lock allow-same-origin allow-scripts' onload='onFrameLoaded(this)' onerror='onFrameError(this);'></iframe></div>":"<div class='nocursor' style='width:100%;height:100%;background-color:white;'></div>")}else if("movingtext"==e){f=$(this).find("bgcolor").text();var D=$(this).find("text").text(),L=$(this).find("border").text(),w=$(this).find("border").attr("color"),b=(f=$(this).find("background").text(),$(this).find("font").attr("color")),x=$(this).find("font").text(),I=1,T=$(this).find("speed").text(),C=$(this).find("transtype").text();try{I=parseFloat(x),isNaN(I)&&(I=100),I/=100}catch(e){I=10}h<=0?(bGotMovingText=!0,glMovingTextPlaylist[n]=[],glMovingTextStringPos[n]=0,glMovingTextPlaylist[n][h]=D,n++,I=getTextSize70Percent(d),MovingTextAdd(t,i,l,d,D,b,I,w,f,L,C,T,s),h++):(glMovingTextPlaylist[n-1][h]=D,h++)}else if("image"==e){var F=$(this).find("effect").text(),M=$(this).find("transtype").text(),P=$(this).find("duration").text(),V=$(this).find("startdate").text(),R=$(this).find("stopdate").text(),U=$(this).find("starttime").text(),O=$(this).find("stoptime").text();""!=a&&(1==++g&&(r++,RegionListAdd(c,t,i,s,l,d),o+="<img id='imgScreen"+r+"Top' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' /><img id='imgScreen"+r+"Bottom' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' />"),RegionPlaylistAdd(r-1,a,y,e,F,M,P,V,R,U,O),sPreloadImages+="<img id='org"+r+"-"+g+"' src='"+a+"' regname='"+c+"'>")}else if("video"==e){F=$(this).find("effect").text(),M=1,P=5e3;var B="video/mp4";V=$(this).find("startdate").text(),R=$(this).find("stopdate").text(),U=$(this).find("starttime").text(),O=$(this).find("stoptime").text();B=-1!==a.indexOf(".m3u8")?"application/x-mpegURL":-1!==a.indexOf(".mp4")?"video/mp4":-1!==a.indexOf(".mpg")?"video/mp4":-1!==a.indexOf(".mpeg")?"video/mp4":-1!==a.indexOf(".ogg")?"video/ogg":"video/mp4",""!=a&&(1==++g&&(r++,iVideoCount<2&&(o+="<video style='position:absolute;visibility:hidden;display:none;z-index:"+(8+s)+";width:100%;height:100%;' "+F+" id='vidObj"+ ++iVideoCount+"'  preload='auto'  poster='md/black1px.png' regname='"+c+"' vidtype='native'>",o+="<source id='vidSrc"+iVideoCount+"' src='"+a+"' type='"+B+"'></video>"),RegionListAdd(c,t,i,s,l,d),o+="<img id='imgScreen"+r+"Top' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' /><img id='imgScreen"+r+"Bottom' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' />"),iVideoCount<3&&(F=""+iVideoCount,RegionPlaylistAdd(r-1,a,y,e,F,M,P,V,R,U,O)))}else if("video2"==e){F=$(this).find("effect").text(),M=1,P=5e3,B="video/mp4",V=$(this).find("startdate").text(),R=$(this).find("stopdate").text(),U=$(this).find("starttime").text(),O=$(this).find("stoptime").text();if(B=-1!==a.indexOf(".m3u8")?"application/x-mpegURL":-1!==a.indexOf(".mp4")?"video/mp4":-1!==a.indexOf(".mpg")?"video/mp4":-1!==a.indexOf(".mpeg")?"video/mp4":-1!==a.indexOf(".ogg")?"video/ogg":"video/mp4",""!=a){if(1==++g){if(r++,iVideoCount<1){iVideoCount++,o+="<video style='position:absolute;visibility:hidden;display:none;z-index:"+(8+s)+";width:100%;height:100%;' "+F+" id='vidObj1'  preload='auto'  poster='md/black1px.png' regname='"+c+"' vidtype='vlc'>",o+="<source id='vidSrc1' src='"+a+"' type='"+B+"'></video>";try{window.external.VLCPlayerDimension(t,i,l,d)}catch(e){}}RegionListAdd(c,t,i,s,l,d),o+="<img id='imgScreen"+r+"Top' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' /><img id='imgScreen"+r+"Bottom' src='md/trans.gif' alt='' onerror='SlideOnError(this);' onload='SlideOnLoad(this);' regname='"+c+"' />"}iVideoCount<2&&(F="1",RegionPlaylistAdd(r-1,a,y,"video",F,M,P,V,R,U,O))}}}),a+=o+"</div>",o=""}),1==e?showPrepDisplay(a):(sDisplayContent=a,runDisplay2())}function onFrameLoaded(e){}function onFrameError(){MAlert("error")}function SetDeviceID(e){sDeviceID=e;try{$("#spSTBIDLogin").html(sDeviceID),$("#spSTBIDLogin2").html(sDeviceID);try{window.localStorage.setItem("deviceid",sDeviceID)}catch(e){}if("windows"==sDevicePlatform)try{window.external.SetLocalStorage("deviceid",sDeviceID)}catch(e){}}catch(e){}}function SetDevicePlatform(e,t){sDevicePlatform=e,sDevicePlatformVersion=t}function GetDeviceID(){return sDeviceID}function GetDevicePlatformName(){return sDevicePlatform}function GetDevicePlatformVersion(){return sDevicePlatformVersion}function ShowDownloadPercentage(e){$("#spPrepPercent").html("("+e+"%)")}$(document).ready(function(){try{document.addEventListener("touchmove",function(e){e.preventDefault()},!1)}catch(e){}try{document.addEventListener("deviceready",onDeviceReady,!1)}catch(e){}$("#dvLiveStreamVLC").css("visibility","hidden"),$("#dvLiveStreamVLC").css("display","none"),$("#dvLiveStreamAndroid").css("visibility","hidden"),$("#dvLiveStreamAndroid").css("display","none");try{String.prototype.fileExist=function(){return filename=this.trim(),"200"==jQuery.ajax({url:filename,type:"GET",method:"GET",isLocal:!1,cache:!1,crossDomain:!0,async:!1}).status}}catch(e){}initDevice(),setKeyPress()});var textlogtry=0,textlogireqtag="0",textlogfname="",textlogmime="";function getTextLog(e,t){try{var i=getTextLogFolder(),a=i+t+".log";if(""!=i)if("android"==sDevicePlatform)textlogtry=0,textlogireqtag=""+e,textlogfname=a,textlogmime="text/plain",uploadFile(a,e,"text/plain");else if("windows"==sDevicePlatform){var o=getURLLocation(sXMLUrl);window.external.HttpUploadFile("http://"+o.host+"/sendlog.php",a,"bindata","text/plain",GetDeviceID(),""+e,getRandomID(10)).indexOf("error")}}catch(e){}}function getScreenShot(e){try{if("android"==sDevicePlatform)navigator.screenshot.save(function(t,i){if(t);else try{uploadFile(i.filePath,e,"image/jpeg")}catch(e){}},"jpg",80,""+getTodayNum()+getTimeStr());else if("windows"==sDevicePlatform)try{var t=window.external.GetScreenShot(""+getTodayNum()+getTimeStr()+".jpg");if(t.indexOf("error")<0){var i=getURLLocation(sXMLUrl);window.external.HttpUploadFile("http://"+i.host+"/sendlog.php",t,"bindata","image/jpeg",GetDeviceID(),""+e,getRandomID(10)).indexOf("error")}}catch(e){}}catch(e){}}function uploadFile(e,t,i){var a=new FileUploadOptions;a.fileKey="bindata",a.fileName=e,a.mimeType=i;var o={act:"sendlog"};o.deviceid=GetDeviceID(),o.reqtag=""+t,o.r=getRandomID(10),a.params=o,a.chunkedMode=!1;try{var r=getURLLocation(sXMLUrl);(new FileTransfer).upload(e,"http://"+r.host+"/sendlog.php",function(){},function(e){if(1==e.code&&1==++textlogtry)return void uploadFile(getAppStorageFolder()+"notfound.txt",textlogireqtag,textlogmime)},a)}catch(e){}}function showInfo(){MAlert("cordova.file.externalApplicationStorageDirectory = "+cordova.file.externalApplicationStorageDirectory)}function getFilename(e){try{return e.replace(/^.*[\\\/]/,"")}catch(t){return e}}function deleteCache(){try{var e=cordova.file.externalApplicationStorageDirectory;clearDirectory(e=e.replace("file://","")+"cache/")}catch(e){}}function clearDirectory(e){try{window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(i){i.root.getDirectory(e,{create:!0,exclusive:!1},function(e){e.removeRecursively(function(){},t)},t)},t)}catch(e){}function t(e){}}var sDisplayContent="";function showPrepDisplay(e){try{sDisplayContent=e,$("#spRegions").html($("#dvPrepScreen").html()),iUpdatableDownloadCounter=0,bDownloadFailed=!1,$("#spPrepInfo").html(""),$("#spPrepStatus").html("Downloading files..."),$("#spPrepFiles").html(iUpdatableDownloadCounter+1+"/"+arUpdatableFileList.length),arFileExistAnd=[],"windows"==GetDevicePlatformName()?startDownload(iUpdatableDownloadCounter):"android"==GetDevicePlatformName()&&checkFileExistAndroid(iUpdatableDownloadCounter)}catch(e){MAlert(e.message)}}var arFileExistAnd=[];function checkFileExistAndroid(e){if(e<arUpdatableFileList.length){var t=getFilenameFromURL(arUpdatableFileList[e]);t="file:///"+getUpdatableFolder()+t,checkIfFileExists(t,e),checkFileExistAndroid(++iUpdatableDownloadCounter)}else iUpdatableDownloadCounter=0,setTimeout("startDownload("+iUpdatableDownloadCounter+");",2e3)}function startDownload(e){if(e<arUpdatableFileList.length){bDownloading=!0,setDownloadingStatus(),$("#spPrepPercent").html("(0%)");var t=!1,i=!0;try{t=FileUpdatableExist(arUpdatableFileList[e],e)}catch(e){}try{i=0!=arUpdatableFileFlag[e]}catch(e){}if(i||!t)downloadFile(arUpdatableFileList[e]);else{$("#spPrepInfo").html($("#spPrepInfo").html()+"<br/>"+getFilenameFromURL(arUpdatableFileList[e])+"&nbsp;<font style='color:yellow'>Exist</font>");var a=getFilenameFromURL(arUpdatableFileList[iUpdatableDownloadCounter]);a=getUpdatableFolder()+a;var o=MatchMD5(a,arUpdatableFileMD5[iUpdatableDownloadCounter],iUpdatableDownloadCounter);"windows"==GetDevicePlatformName()&&(arUpdatableFileMD5Result[iUpdatableDownloadCounter]=o?"1":"0"),++iUpdatableDownloadCounter<arUpdatableFileList.length?($("#spPrepFiles").html(iUpdatableDownloadCounter+1+"/"+arUpdatableFileList.length),startDownload(iUpdatableDownloadCounter)):($("#spPrepInfo").html($("#spPrepInfo").html()+"<br/><br/>Validating Files..."),bDownloadFailed||setTimeout("runDisplay();",1e4))}}else 0==bDownloadFailed?0==arUpdatableFileList.length&&($("#spPrepInfo").html(""),$("#spPrepStatus").html("Loading..."),$("#spPrepFiles").html(""),$("#spPrepPercent").html(""),setTimeout("runDisplay();",1e4)):(iRetryCount=5,$("#btnReset2").css("visibility","visible"),$("#spPrepInfo").html($("#spPrepInfo").html()+"<br/><br/>Retrying in "+iRetryCount+" second..."),setTimeout("retryDownload();",2e3))}var iRetryCount=5;function retryDownload(){--iRetryCount<2?$("#btnReset2").css("visibility","hidden"):$("#btnReset2").css("visibility","visible"),iRetryCount<=0?($("#spPrepInfo").html(""),loadLayoutFromStorage(!0)):($("#spPrepInfo").html($("#spPrepInfo").html()+"<br/>Retrying in "+iRetryCount+" second..."),setTimeout("retryDownload();",2e3))}function runDisplay(){bDownloading=!1,setDownloadingStatus();for(var e=0,t=0;t<arUpdatableFileMD5Result.length;t++)"0"==arUpdatableFileMD5Result[t]&&e++;if(e>0)return $("#spRegions").html("<div style='width:100%;height:100%;background-color:black;'><center><h1 style='color:white;'><br/><br/><br/><br/><br/>Invalid content detected, please reset device!</h1></center></div>"),$(".dvReset").css("visibility","visible"),void $(".dvReset").css("display","block");setTimeout("runDisplay2();",5e3)}function runDisplay2(){$("#spRegions").html(sDisplayContent),$("#spPreLoadImages").html(sPreloadImages),MovingTextStart(),setTimeout("setKeyPress();",5e3),SetFirstImageForMixedContent(),iMixedContentTimerID=setInterval("MixedContentTimer();",100),runCheckVersionTimer(),$(".dvReset").css("visibility","visible"),$(".dvReset").css("display","block"),bShowingMenu=!1,iCheckLiveStreamTimer=setInterval("CheckLiveStream();",6500)}function SetFirstImageForMixedContent(){try{for(var e=0;e<listRegion.length;e++){arFirstSlideLoop=[];for(e=0;e<listRegion.length;e++)arFirstSlideLoop.push(!0);for(var t=0;t<listRegion.length;t++)for(var i=listRegion[t],a=!0,o=0;o<i.playlist.length;o++)for(var r=0,n=0,s=0,l=0,d=100;d>0;){try{r=parseInt(i.playlist[o].startdate,10),n=parseInt(i.playlist[o].stopdate,10);try{s=parseInt(i.playlist[o].starttime,10),l=parseInt(i.playlist[o].stoptime,10)}catch(e){s=0,l=0}var c=getTodayNum(),m=parseInt(getTimeStr(),10);if(isNaN(r)&&(r=0),isNaN(n)&&(n=0),isNaN(s)&&(s=0),isNaN(l)&&(l=0),s>l&&(m<l&&m>=0&&(m+=24e4),l+=24e4),0==s&&l&&(s=0,l=235959),c>=r&&c<=n&&m>=s&&m<=l){1==a&&($("#imgScreen"+(t+1)+"Top").attr("src",$("#org"+(t+1)+"-"+(o+1)).attr("src")),$("#imgScreen"+(t+1)+"Bottom").attr("src",$("#org"+(t+1)+"-"+(o+1)).attr("src")),a=!1);break}break}catch(e){}d--}}}catch(e){}try{document.getElementById("vidObj1").addEventListener("ended",VideoEnded1)}catch(e){}try{document.getElementById("vidObj2").addEventListener("ended",VideoEnded2)}catch(e){}}function VideoStart(e,t){try{if(1==t&&(isVideoEnded1=!1,isVideoPlaying1=!0),2==t&&(isVideoEnded2=!1,isVideoPlaying2=!0),"vlc"==$("#vidObj"+t).attr("vidtype"))try{"windows"==GetDevicePlatformName()&&(window.external.VLCPlayerAddFile(e),window.external.VLCPlayerStart())}catch(e){setTimeout("VideoEnded1();",1e3)}else{$("#vidObj"+t).css("visibility","visible"),$("#vidObj"+t).css("display","block"),$("#vidObj"+t).css("z-index","3000");var i=document.getElementById("vidObj"+t);document.getElementById("vidSrc"+t).src=e,1==t&&i.addEventListener("ended",VideoEnded1),2==t&&i.addEventListener("ended",VideoEnded2),i.load(),i.play()}try{WriteTextLog($("#vidObj"+t).attr("regname")+"|"+getFilenameFromURL(e)+"|success")}catch(e){}}catch(e){}}function VideoEnded1(){$("#vidObj1").css("visibility","hidden"),isVideoEnded1=!0,isVideoPlaying1=!1;try{"windows"==GetDevicePlatformName()&&window.external.VLCPlayerStop()}catch(e){}}function VideoEnded2(){$("#vidObj2").css("visibility","hidden"),isVideoEnded2=!0,isVideoPlaying2=!1;try{"windows"==GetDevicePlatformName()&&window.external.VLCPlayerStop()}catch(e){}}var isVideoPlaying1=!1,isVideoEnded1=!1,isVideoPlaying2=!1,isVideoEnded2=!1;function MixedContentTimer(){if(1!=iShowLiveStream)try{for(var e=0;e<listRegion.length;e++)try{for(var t=listRegion[e],i=t.playlistIndex,a=0,o=0,r=0,n=0,s=100;s>0;){try{a=parseInt(t.playlist[i].startdate,10),o=parseInt(t.playlist[i].stopdate,10);try{r=parseInt(t.playlist[i].starttime,10),n=parseInt(t.playlist[i].stoptime,10)}catch(e){r=0,n=0}var l=getTodayNum(),d=parseInt(getTimeStr(),10);isNaN(a)&&(a=0),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(n)&&(n=0),r>n&&(d<n&&d>=0&&(d+=24e4),n+=24e4),0==r&&n&&(r=0,n=235959),l>=a&&l<=o&&d>=r&&d<=n||"video"==t.playlist[i].media&&(t.playlist[i].timer=t.playlist[i].duration)}catch(e){}s--}var c=0;"video"==t.playlist[i].media&&(c=t.playlist[i].effect);var m=!1;if(1==c&&(m=isVideoEnded1),2==c&&(m=isVideoEnded2),t.playlist[i].timer<=t.playlist[i].duration&&!m)t.playlist[i].timer+=100,"video"==t.playlist[i].media&&t.playlist[i].timer>1e3&&(1==c&&0==isVideoPlaying1&&VideoStart(t.playlist[i].url,t.playlist[i].effect),2==c&&0==isVideoPlaying2&&VideoStart(t.playlist[i].url,t.playlist[i].effect),t.playlist[i].timer=1500);else{t.playlist[i].timer=0;var g=i+1;for(a=0,o=0,r=0,n=0,s=100;s>0;){try{g>=t.playlist.length&&(g=0),a=parseInt(t.playlist[g].startdate,10),o=parseInt(t.playlist[g].stopdate,10);try{r=parseInt(t.playlist[g].starttime,10),n=parseInt(t.playlist[g].stoptime,10)}catch(e){r=0,n=0}l=getTodayNum(),d=parseInt(getTimeStr(),10);if(isNaN(a)&&(a=0),isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(n)&&(n=0),r>n&&(d<n&&d>=0&&(d+=24e4),n+=24e4),0==r&&n&&(r=0,n=235959),l>=a&&l<=o&&d>=r&&d<=n){t.playlistIndex=g;break}g++}catch(e){}s--}if(0==s&&(g=i,t.playlistIndex=g),g==i&&"image"==t.playlist[g].media){$("#imgScreen"+(e+1)+"Top").attr("src",$("#org"+(e+1)+"-"+(g+1)).attr("src")),$("#imgScreen"+(e+1)+"Bottom").attr("src",$("#org"+(e+1)+"-"+(g+1)).attr("src"));continue}if("image"==t.playlist[g].media)if("video"==t.playlist[i].media)FadeTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z),1==c&&(isVideoEnded1=!1),2==c&&(isVideoEnded2=!1),$("#vidObj"+c).css("visibility","hidden"),$("#vidObj"+c).css("display","none");else if(1==arFirstSlideLoop[e])arFirstSlideLoop[e]=!1,$("#imgScreen"+(e+1)+"Top").attr("src",$("#org"+(e+1)+"-"+(g+1)).attr("src")),$("#imgScreen"+(e+1)+"Bottom").attr("src",$("#org"+(e+1)+"-"+(g+1)).attr("src"));else switch(t.playlist[g].transtype){case 1:FadeTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 2:LeftToRight("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 3:RightToLeft("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 4:TopToBottom("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 5:BottomToTop("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 6:ShrinkTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;case 7:ClipTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z);break;default:FadeTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"org"+(e+1)+"-"+(g+1),t.z)}else"video"==t.playlist[g].media&&("video"==t.playlist[i].media?(t.playlist[i].timer=0,t.playlist[g].timer=0,1==c&&(isVideoPlaying1=!1,isVideoEnded1=!1),2==c&&(isVideoPlaying2=!1,isVideoEnded2=!1)):FadeTo("imgScreen"+(e+1),"org"+(e+1)+"-"+(i+1),"imgBlack",t.z))}}catch(e){}}catch(e){}}function setKeyPress(){try{$("#mkey").keypress(function(e){if(27==e.which);else if(96==e.which)initContent();else{if(42!=e.which)return;initContent()}e.preventDefault()}),$("#mkey").focus()}catch(e){}}function runCheckVersionTimer(){"Offline"==sOnlineMode||(-1!=iVersionCheckTimer&&clearInterval(iVersionCheckTimer),iVersionCheckTimer=setInterval("CheckVersion()",3e4))}function CheckVersion(){if(1!=bCheckingVersion&&(bCheckingVersion=!0,1!=iShowLiveStream))try{getJSONDataStringFromURLAsync("http://"+getURLLocation(sXMLUrl).host+"/getlayoutver.php","act=getlayoutver&deviceid="+GetDeviceID()+"&layoutid="+sLayoutID+"&r="+getRandomID(10),1)}catch(e){}}function toggleDebugLog(){iShowDebugLog*=-1,getJSONLiveStreamFromURLAsync("http://"+getURLLocation(sXMLUrl).host+"/livestream.php","act=enablestream&deviceid="+GetDeviceID())}function CheckLiveStream(){bShowingMenu||"Offline"==sOnlineMode||getJSONLiveStreamFromURLAsync("http://"+getURLLocation(sXMLUrl).host+"/livestream.php","act=enablestream&deviceid="+GetDeviceID())}function ShowLiveStream(e){try{try{$("#vidObj1").get(0).pause()}catch(e){}try{$("#vidObj2").get(0).pause()}catch(e){}iShowLiveStream=1;var t=get16x9Size();if("windows"==GetDevicePlatformName()){try{window.external.VLCPlayerPause()}catch(e){}$("#dvLiveStreamVLC").css("left",t.left+"%"),$("#dvLiveStreamVLC").css("top",t.top+"%"),$("#dvLiveStreamVLC").css("width",t.width+"%"),$("#dvLiveStreamVLC").css("height",t.height+"%"),$("#dvLiveStreamVLC").css("display","block"),$("#dvLiveStreamVLC").css("visibility","visible"),$("#vlcstream").css("width","100%"),$("#vlcstream").css("height","100%");var i=getVLC("vlcstream");i.playlist.stop(),i.playlist.clear(),i.playlist.add(e),i.playlist.play()}else $("#dvLiveStreamAndroid").css("left",t.left+"%"),$("#dvLiveStreamAndroid").css("top",t.top+"%"),$("#dvLiveStreamAndroid").css("width",t.width+"%"),$("#dvLiveStreamAndroid").css("height",t.height+"%"),$("#dvLiveStreamAndroid").css("display","block"),$("#dvLiveStreamAndroid").css("visibility","visible"),$("#vidLiveStream").attr("src",e),$("#vidLiveStream").get(0).load(),$("#vidLiveStream").get(0).play()}catch(e){}}function StopLiveStream(){try{$("#dvLiveStreamVLC").css("visibility","hidden"),$("#dvLiveStreamVLC").css("display","none");try{$("#vidObj1").get(0).play()}catch(e){}try{$("#vidObj2").get(0).play()}catch(e){}if(iShowLiveStream=-1,"windows"==GetDevicePlatformName()){try{window.external.VLCPlayerPlay()}catch(e){}var e=getVLC("vlcstream");e.playlist.stop(),e.playlist.clear()}else $("#vidLiveStream").get(0).pause(),$("#dvLiveStreamAndroid").css("visibility","hidden"),$("#dvLiveStreamAndroid").css("display","none")}catch(e){}}function CheckHB(){return getRandomID(10)}function getJSONLiveStreamFromURLAsync(e,t){try{$.ajax({type:"POST",method:"POST",cache:!1,url:e,dataType:"json",contentType:"application/x-www-form-urlencoded",data:t+"&r="+getRandomID(10),processData:!1,crossDomain:!0,async:!0,success:function(e){var t={success:!0,data:e};try{if(t.success){var i=t.data.active,a=0;try{a=parseInt(t.data.success)}catch(e){a=0}isNaN(a)&&(a=0),1==a&&(i?ShowLiveStream(t.data.url):StopLiveStream())}}catch(e){}},error:function(e){!1;try{void 0===e.responseJSON.errmsg&&e.status+" "+e.statusText}catch(t){e.status+" "+e.statusText}},timeout:2e3})}catch(e){}}